day=`date -d '-1 day' +%Y%m%d`
hive -e "drop table gkznkr.pon_ods_serv_order_day_t;"
hive -e "create table gkznkr.pon_ods_serv_order_day_t as select month,week,olt_ip,olt_name,olt_pon_type,pon_id,olt_pon_code,name,substr(ponfree,1,250) ponfree,olt_type,type,speed,out,in,outper,inper,out_last,in_last,usrnum,usrnum_last,sn_code,pvlan,cvlan,site_name,obd_device_code,obd_device_name,obd_device_addr,up_obd_code,up_obd_name,up_obd_add,prod_id,prod_type,prod_spec_id,prod_spec_name,acc_types,acc_nbr1,acc_nbr2,fzj_code,area_id,area_name,local_id,local_name,zy_gird_id,zy_gird_name,yx_gird_id,yx_gird_name,serv_id,cust_id,star_month_id,vip_class,product_id,product_name,product_offer_id,offer_name,rate,billing_cycle_id,inv_amt,inv_bill_amt,open_date,close_date,pd_inst_state,strategy_segment,flag_200m,flag_500m,flag_zq,flag_free,ptday from gkznkr.pon_ods_serv_order_day where ptday=$day;"
sqoop export --table pon_ods_serv_order_day --connect jdbc:oracle:thin:@133.0.194.15:1521:aniam --username odso --password odso_123 --export-dir /user/hive/warehouse/gkznkr.db/pon_ods_serv_order_day_t --columns MONTH,WEEK,OLT_IP,OLT_NAME,OLT_PON_TYPE,PON_ID,OLT_PON_CODE,NAME,PONFREE,OLT_TYPE,TYPE,SPEED,OUT_FLOW,IN_FLOW,OUTPER,INPER,OUT_LAST,IN_LAST,USRNUM,USRNUM_LAST,SN_CODE,PVLAN,CVLAN,SITE_NAME,OBD_DEVICE_CODE,OBD_DEVICE_NAME,OBD_DEVICE_ADDR,UP_OBD_CODE,UP_OBD_NAME,UP_OBD_ADD,PROD_ID,PROD_TYPE,PROD_SPEC_ID,PROD_SPEC_NAME,ACC_TYPES,ACC_NBR1,ACC_NBR2,FZJ_CODE,AREA_ID,AREA_NAME,LOCAL_ID,LOCAL_NAME,ZY_GIRD_ID,ZY_GIRD_NAME,YX_GIRD_ID,YX_GIRD_NAME,SERV_ID,CUST_ID,STAR_MONTH_ID,VIP_CLASS,PRODUCT_ID,PRODUCT_NAME,PRODUCT_OFFER_ID,OFFER_NAME,RATE,BILLING_CYCLE_ID,INV_AMT,INV_BILL_AMT,OPEN_DATE,CLOSE_DATE,PD_INST_STATE,STRATEGY_SEGMENT,FLAG_200M,FLAG_500M,FLAG_ZQ,FLAG_FREE,PTDAY --input-fields-terminated-by '\001' --input-lines-terminated-by '\n' --input-null-string '\\N' --input-null-non-string '\\N' 


